SELECT c.*, s.status FROM public."openincs_companies_v5" c LEFT JOIN public.user_company_status s ON s.company_id = c.company_id AND s.type = 'Company' AND s.user_id = {{appsmith.store.user_id}}
WHERE (({{this.params.company || '<NULL>'}} = '<NULL>' OR LOWER(c.name) LIKE '%' || {{this.params.company?.toLowerCase()}} || '%')
OR ({{this.params.company || '<NULL>'}} = '<NULL>' OR LOWER(c.industry) LIKE '%' || {{this.params.company?.toLowerCase()}} || '%'))
AND ({{sel_status.selectedOptionValue || '<NULL>'}} = '<NULL>' OR s.status = {{sel_status.selectedOptionValue}})
ORDER BY c.summary <> '' DESC, c.name
LIMIT {{tbl_companies.pageSize}} OFFSET {{(tbl_companies.pageNo - 1) * tbl_companies.pageSize}};